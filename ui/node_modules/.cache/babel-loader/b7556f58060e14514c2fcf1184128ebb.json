{"ast":null,"code":"var _jsxFileName = \"/home/gregorian/calendar-ui/ui/src/components/forms/JobForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useReducer } from \"react\";\nimport mongoose from \"mongoose/browser\";\nimport { useInput } from \"../hooks/useInput\";\nimport { useArray } from \"../hooks/useArray\";\nimport { startEndChange, StartEndInput } from \"./StartEndInput\";\nimport styled from \"styled-components\";\nimport { useImmerReducer } from \"use-immer\";\nimport camelCase from \"camelcase\";\nimport { Formik, Field } from \"formik\";\nimport { cloneDeep, values, flatten } from \"lodash\"; //import { styled } from \"@mui/material/styles\";\n\nimport { ListBuilder } from \"./AddressInput\";\nimport { TextField, Grid, Button } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport DateFnsUtils from \"@date-io/date-fns\"; // choose your lib\n\nimport { rootReducer } from \"./reducer\";\nimport { editJob } from \"../../Model/Jobs\";\nimport { DatePicker, TimePicker, MuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport { Typography } from \"@material-ui/core\";\nimport { jobSchema } from \"api/model/job\"; //TODO change name of buildSchema\n\nimport processMongooseError from \"./../../utilities/processMongooseError\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction dateTimeFromInput(date, time) {\n  const hours = time.getHours();\n  const minutes = time.getMinutes();\n  let res = new Date(date);\n  res.setHours(hours);\n  res.setMinutes(minutes);\n  return res;\n}\n\nconst FlexRow = styled.div`\n  display: flex;\n`;\n_c = FlexRow;\nconst useStyles = makeStyles({\n  flexItem: {\n    flex: \"1 1 0\",\n    \"&:not(:last-child)\": {\n      marginRight: \"10px\"\n    }\n  },\n  inputRow: {\n    marginBottom: \"10px\"\n  },\n  textField: {\n    \"& textarea\": {\n      whiteSpace: \"pre-line\"\n    }\n  }\n});\nexport default function JobForm({\n  updateEvent,\n  close,\n  toggleModal,\n  initialValues\n}) {\n  _s();\n\n  const classes = useStyles();\n  console.log(initialValues);\n\n  const handleSubmit = data => {\n    console.log(data);\n    const {\n      _id\n    } = data;\n    editJob({\n      _id: _id,\n      data: data\n    }).then(response => {\n      if (response.status === \"success\") {\n        onSuccess(_id, response.data);\n      } else if (response.status === \"fail\" && response.name === \"validationError\") {\n        console.log(\"i need validation\");\n      }\n    }).catch(console.error);\n  };\n\n  function onSuccess(_id, data) {\n    updateEvent(_id, data);\n    close();\n  }\n\n  function handleNested(error, formikErrors) {}\n\n  const validator = values => {\n    const doc = new mongoose.Document(values, jobSchema);\n    console.log(processMongooseError);\n    const result = processMongooseError(doc.validateSync());\n    const pretty = JSON.stringify(result || {}, null, 2);\n    console.log(pretty);\n    return {};\n  };\n\n  return /*#__PURE__*/_jsxDEV(Formik, {\n    initialValues: cloneDeep(initialValues),\n    onSubmit: handleSubmit,\n    validate: validator,\n    children: props => {\n      var _props$errors, _props$errors$custome, _props$errors2, _props$errors2$custom, _props$errors3, _props$errors3$charge, _props$errors4, _props$errors4$charge, _props$errors5, _props$errors5$charge, _props$errors6, _props$errors6$charge, _props$errors7, _props$errors7$charge, _props$errors8, _props$errors8$charge, _props$errors9, _props$errors10;\n\n      return (\n        /*#__PURE__*/\n        //<Typography variant=\"h4\">Create Job</Typography>\n        _jsxDEV(\"form\", {\n          onSubmit: props.handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(Field, {\n            as: TextField,\n            className: classes.inputRow,\n            name: \"customer.name\",\n            label: \"name\",\n            error: (_props$errors = props.errors) === null || _props$errors === void 0 ? void 0 : (_props$errors$custome = _props$errors.customer) === null || _props$errors$custome === void 0 ? void 0 : _props$errors$custome.name,\n            helperText: (_props$errors2 = props.errors) === null || _props$errors2 === void 0 ? void 0 : (_props$errors2$custom = _props$errors2.customer) === null || _props$errors2$custom === void 0 ? void 0 : _props$errors2$custom.name,\n            fullWidth: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Field, {\n            as: TextField,\n            className: classes.inputRow,\n            name: \"customer.mobile\",\n            label: \"mobile\",\n            fullWidth: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Field, {\n            as: TextField,\n            className: classes.inputRow,\n            name: \"customer.email\",\n            label: \"email\",\n            fullWidth: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(FlexRow, {\n            className: classes.inputRow,\n            children: [/*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n              utils: DateFnsUtils,\n              children: /*#__PURE__*/_jsxDEV(TimePicker, {\n                className: classes.flexItem,\n                value: props.values.start,\n                onChange: props.handleChange,\n                label: \"date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n              utils: DateFnsUtils,\n              children: /*#__PURE__*/_jsxDEV(TimePicker, {\n                className: classes.flexItem,\n                value: props.values.end,\n                onChange: props.handleChange,\n                label: \"date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n              utils: DateFnsUtils,\n              children: /*#__PURE__*/_jsxDEV(DatePicker, {\n                className: classes.flexItem,\n                value: props.values.start,\n                onChange: date => {\n                  props.setFieldValue(\"start\", dateTimeFromInput(date, props.values.start), true);\n                  props.setFieldValue(\"end\", dateTimeFromInput(date, props.values.end), true);\n                  console.log(\"hello\");\n                },\n                label: \"end\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(FlexRow, {\n            className: classes.inputRow,\n            children: [/*#__PURE__*/_jsxDEV(Field, {\n              className: classes.flexItem,\n              as: TextField,\n              name: \"charges.hourlyRate\",\n              label: \"hourly rate\",\n              error: (_props$errors3 = props.errors) === null || _props$errors3 === void 0 ? void 0 : (_props$errors3$charge = _props$errors3.charges) === null || _props$errors3$charge === void 0 ? void 0 : _props$errors3$charge.hourlyRate,\n              helperText: (_props$errors4 = props.errors) === null || _props$errors4 === void 0 ? void 0 : (_props$errors4$charge = _props$errors4.charges) === null || _props$errors4$charge === void 0 ? void 0 : _props$errors4$charge.hourlyRate,\n              fullWidth: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Field, {\n              className: classes.flexItem,\n              as: TextField,\n              name: \"charges.fuelCharge\",\n              label: \"fuelCharge\",\n              error: (_props$errors5 = props.errors) === null || _props$errors5 === void 0 ? void 0 : (_props$errors5$charge = _props$errors5.charges) === null || _props$errors5$charge === void 0 ? void 0 : _props$errors5$charge.fuelCharge,\n              helperText: (_props$errors6 = props.errors) === null || _props$errors6 === void 0 ? void 0 : (_props$errors6$charge = _props$errors6.charges) === null || _props$errors6$charge === void 0 ? void 0 : _props$errors6$charge.fuelCharge,\n              fullWidth: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Field, {\n              className: classes.flexItem,\n              as: TextField,\n              name: \"charges.travelTime\",\n              label: \"travelTime\",\n              error: (_props$errors7 = props.errors) === null || _props$errors7 === void 0 ? void 0 : (_props$errors7$charge = _props$errors7.charges) === null || _props$errors7$charge === void 0 ? void 0 : _props$errors7$charge.travelTime,\n              helperText: (_props$errors8 = props.errors) === null || _props$errors8 === void 0 ? void 0 : (_props$errors8$charge = _props$errors8.charges) === null || _props$errors8$charge === void 0 ? void 0 : _props$errors8$charge.travelTime,\n              fullWidth: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Field, {\n            as: TextField,\n            className: classes.inputRow,\n            name: \"items\",\n            label: \"items\",\n            error: (_props$errors9 = props.errors) === null || _props$errors9 === void 0 ? void 0 : _props$errors9.items,\n            helperText: (_props$errors10 = props.errors) === null || _props$errors10 === void 0 ? void 0 : _props$errors10.items,\n            fullWidth: true,\n            multiline: true,\n            rows: 5\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(ListBuilder, {\n            value: props.values.addresses,\n            onChange: props.handleChange,\n            label: \"add address\",\n            name: \"addresses\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(ListBuilder, {\n            value: props.values.operatives,\n            onChange: props.handleChange,\n            label: \"add operative\",\n            name: \"operatives\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\" // onClick={(e) => {\n            //    e.preventDefault();\n            //    props.handleSubmit(values); //TODO should i be cloning object before apssing it about\n            //  }}\n            ,\n            variant: \"contained\",\n            color: \"primary\",\n            fullWidth: true,\n            children: \"save\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 9\n        }, this)\n      );\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n}\n\n_s(JobForm, \"8g5FPXexvSEOsxdmU7HicukHGqY=\", false, function () {\n  return [useStyles];\n});\n\n_c2 = JobForm;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"FlexRow\");\n$RefreshReg$(_c2, \"JobForm\");","map":{"version":3,"sources":["/home/gregorian/calendar-ui/ui/src/components/forms/JobForm.js"],"names":["React","useReducer","mongoose","useInput","useArray","startEndChange","StartEndInput","styled","useImmerReducer","camelCase","Formik","Field","cloneDeep","values","flatten","ListBuilder","TextField","Grid","Button","makeStyles","DateFnsUtils","rootReducer","editJob","DatePicker","TimePicker","MuiPickersUtilsProvider","Typography","jobSchema","processMongooseError","dateTimeFromInput","date","time","hours","getHours","minutes","getMinutes","res","Date","setHours","setMinutes","FlexRow","div","useStyles","flexItem","flex","marginRight","inputRow","marginBottom","textField","whiteSpace","JobForm","updateEvent","close","toggleModal","initialValues","classes","console","log","handleSubmit","data","_id","then","response","status","onSuccess","name","catch","error","handleNested","formikErrors","validator","doc","Document","result","validateSync","pretty","JSON","stringify","props","errors","customer","start","handleChange","end","setFieldValue","charges","hourlyRate","fuelCharge","travelTime","items","addresses","operatives"],"mappings":"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","sourcesContent":["import React, { useReducer } from \"react\";\nimport mongoose from \"mongoose/browser\";\nimport { useInput } from \"../hooks/useInput\";\nimport { useArray } from \"../hooks/useArray\";\nimport { startEndChange, StartEndInput } from \"./StartEndInput\";\nimport styled from \"styled-components\";\nimport { useImmerReducer } from \"use-immer\";\nimport camelCase from \"camelcase\";\nimport { Formik, Field } from \"formik\";\nimport { cloneDeep, values, flatten } from \"lodash\";\n//import { styled } from \"@mui/material/styles\";\n\nimport { ListBuilder } from \"./AddressInput\";\n\nimport { TextField, Grid, Button } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport DateFnsUtils from \"@date-io/date-fns\"; // choose your lib\n\nimport { rootReducer } from \"./reducer\";\nimport { editJob } from \"../../Model/Jobs\";\n\nimport {\n  DatePicker,\n  TimePicker,\n  MuiPickersUtilsProvider,\n} from \"@material-ui/pickers\";\n\nimport { Typography } from \"@material-ui/core\";\n\nimport { jobSchema } from \"api/model/job\"; //TODO change name of buildSchema\nimport processMongooseError from \"./../../utilities/processMongooseError\";\n\nfunction dateTimeFromInput(date, time) {\n  const hours = time.getHours();\n  const minutes = time.getMinutes();\n  let res = new Date(date);\n  res.setHours(hours);\n  res.setMinutes(minutes);\n  return res;\n}\n\nconst FlexRow = styled.div`\n  display: flex;\n`;\n\nconst useStyles = makeStyles({\n  flexItem: {\n    flex: \"1 1 0\",\n    \"&:not(:last-child)\": {\n      marginRight: \"10px\",\n    },\n  },\n  inputRow: {\n    marginBottom: \"10px\",\n  },\n  textField: {\n    \"& textarea\": {\n      whiteSpace: \"pre-line\",\n    },\n  },\n});\n\nexport default function JobForm({\n  updateEvent,\n  close,\n  toggleModal,\n  initialValues,\n}) {\n  const classes = useStyles();\n\n  console.log(initialValues);\n\n  const handleSubmit = (data) => {\n    console.log(data);\n    const { _id } = data;\n    editJob({ _id: _id, data: data })\n      .then((response) => {\n        if (response.status === \"success\") {\n          onSuccess(_id, response.data);\n        } else if (\n          response.status === \"fail\" &&\n          response.name === \"validationError\"\n        ) {\n          console.log(\"i need validation\");\n        }\n      })\n      .catch(console.error);\n  };\n\n  function onSuccess(_id, data) {\n    updateEvent(_id, data);\n    close();\n  }\n\n  function handleNested(error, formikErrors) {}\n\n  const validator = (values) => {\n    const doc = new mongoose.Document(values, jobSchema);\n\n    console.log(processMongooseError);\n\n    const result = processMongooseError(doc.validateSync());\n    const pretty = JSON.stringify(result || {}, null, 2);\n    console.log(pretty);\n\n    return {};\n  };\n\n  return (\n    <Formik\n      initialValues={cloneDeep(initialValues)}\n      onSubmit={handleSubmit}\n      validate={validator}\n    >\n      {(props) => (\n        //<Typography variant=\"h4\">Create Job</Typography>\n        <form onSubmit={props.handleSubmit}>\n          <Field\n            as={TextField}\n            className={classes.inputRow}\n            name=\"customer.name\"\n            label=\"name\"\n            error={props.errors?.customer?.name}\n            helperText={props.errors?.customer?.name}\n            fullWidth\n          />\n          <Field\n            as={TextField}\n            className={classes.inputRow}\n            name=\"customer.mobile\"\n            label=\"mobile\"\n            fullWidth\n          />\n          <Field\n            as={TextField}\n            className={classes.inputRow}\n            name=\"customer.email\"\n            label=\"email\"\n            fullWidth\n          />\n          <FlexRow className={classes.inputRow}>\n            <MuiPickersUtilsProvider utils={DateFnsUtils}>\n              <TimePicker\n                className={classes.flexItem}\n                value={props.values.start}\n                onChange={props.handleChange}\n                label=\"date\"\n              />\n            </MuiPickersUtilsProvider>\n            <MuiPickersUtilsProvider utils={DateFnsUtils}>\n              <TimePicker\n                className={classes.flexItem}\n                value={props.values.end}\n                onChange={props.handleChange}\n                label=\"date\"\n              />\n            </MuiPickersUtilsProvider>\n            <MuiPickersUtilsProvider utils={DateFnsUtils}>\n              <DatePicker\n                className={classes.flexItem}\n                value={props.values.start}\n                onChange={(date) => {\n                  props.setFieldValue(\n                    \"start\",\n                    dateTimeFromInput(date, props.values.start),\n                    true\n                  );\n                  props.setFieldValue(\n                    \"end\",\n                    dateTimeFromInput(date, props.values.end),\n                    true\n                  );\n                  console.log(\"hello\");\n                }}\n                label=\"end\"\n              />\n            </MuiPickersUtilsProvider>\n          </FlexRow>\n\n          <FlexRow className={classes.inputRow}>\n            <Field\n              className={classes.flexItem}\n              as={TextField}\n              name=\"charges.hourlyRate\"\n              label=\"hourly rate\"\n              error={props.errors?.charges?.hourlyRate}\n              helperText={props.errors?.charges?.hourlyRate}\n              fullWidth\n            />\n            <Field\n              className={classes.flexItem}\n              as={TextField}\n              name=\"charges.fuelCharge\"\n              label=\"fuelCharge\"\n              error={props.errors?.charges?.fuelCharge}\n              helperText={props.errors?.charges?.fuelCharge}\n              fullWidth\n            />\n            <Field\n              className={classes.flexItem}\n              as={TextField}\n              name=\"charges.travelTime\"\n              label=\"travelTime\"\n              error={props.errors?.charges?.travelTime}\n              helperText={props.errors?.charges?.travelTime}\n              fullWidth\n            />\n          </FlexRow>\n\n          <Field\n            as={TextField}\n            className={classes.inputRow}\n            name=\"items\"\n            label=\"items\"\n            error={props.errors?.items}\n            helperText={props.errors?.items}\n            fullWidth\n            multiline\n            rows={5}\n          />\n          <ListBuilder\n            value={props.values.addresses}\n            onChange={props.handleChange}\n            label=\"add address\"\n            name=\"addresses\"\n          />\n          <ListBuilder\n            value={props.values.operatives}\n            onChange={props.handleChange}\n            label=\"add operative\"\n            name=\"operatives\"\n          />\n\n          {/* <MuiPickersUtilsProvider utils={DateFnsUtils}>\n        <TimePicker\n          value={startValue}\n          onChange={onStartChange}\n          label=\"start\"\n        />\n      </MuiPickersUtilsProvider>\n\n      <MuiPickersUtilsProvider utils={DateFnsUtils}>\n        <TimePicker value={endValue} onChange={onEndChange} label=\"end\" />\n      </MuiPickersUtilsProvider> */}\n          {/*<FieldSet inline>\n          <TextField\n            inputProps={{ \"data-group\": \"charges\" }}\n            name=\"hourly-rate\"\n            label=\"Hourly Rate\"\n            value={state.charges.hourlyRate}\n            onChange={groupItemChange}\n            fullWidth\n          />\n          <TextField\n            inputProps={{ \"data-group\": \"charges\" }}\n            name=\"fuel-charge\"\n            label=\"Fuel Charge\"\n            value={state.charges.fuelCharge}\n            onChange={groupItemChange}\n            fullWidth\n          />\n          <TextField\n            inputProps={{ \"data-group\": \"charges\" }}\n            name=\"travel-time\"\n            label=\"Travel Time\"\n            value={state.charges.travelTime}\n            onChange={groupItemChange}\n            fullWidth\n          />\n        </FieldSet>\n        <AddressInput\n          value={state.addresses}\n          onChange={itemChange}\n          name=\"addresses\"\n        /> */}\n          <Button\n            type=\"submit\"\n            // onClick={(e) => {\n            //    e.preventDefault();\n            //    props.handleSubmit(values); //TODO should i be cloning object before apssing it about\n            //  }}\n            variant=\"contained\"\n            color=\"primary\"\n            fullWidth\n          >\n            save\n          </Button>\n        </form>\n      )}\n    </Formik>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}