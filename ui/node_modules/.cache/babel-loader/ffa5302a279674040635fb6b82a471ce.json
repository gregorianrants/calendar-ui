{"ast":null,"code":"'use strict';\n\nconst cloneRegExp = require('regexp-clone');\n\nconst Decimal = require('../types/decimal128');\n\nconst ObjectId = require('../types/objectid');\n\nconst specialProperties = require('./specialProperties');\n\nconst isMongooseObject = require('./isMongooseObject');\n\nconst getFunctionName = require('./getFunctionName');\n\nconst isBsonType = require('./isBsonType');\n\nconst isObject = require('./isObject');\n\nconst symbols = require('./symbols');\n\nconst trustedSymbol = require('./query/trusted').trustedSymbol;\n\nconst utils = require('../utils');\n/*!\n * Object clone with Mongoose natives support.\n *\n * If options.minimize is true, creates a minimal data object. Empty objects and undefined values will not be cloned. This makes the data payload sent to MongoDB as small as possible.\n *\n * Functions are never cloned.\n *\n * @param {Object} obj the object to clone\n * @param {Object} options\n * @param {Boolean} isArrayChild true if cloning immediately underneath an array. Special case for minimize.\n * @return {Object} the cloned object\n * @api private\n */\n\n\nfunction clone(obj, options, isArrayChild) {\n  if (obj == null) {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return cloneArray(obj, options);\n  }\n\n  if (isMongooseObject(obj)) {\n    // Single nested subdocs should apply getters later in `applyGetters()`\n    // when calling `toObject()`. See gh-7442, gh-8295\n    if (options && options._skipSingleNestedGetters && obj.$isSingleNested) {\n      options = Object.assign({}, options, {\n        getters: false\n      });\n    }\n\n    if (utils.isPOJO(obj) && obj.$__ != null && obj._doc != null) {\n      return obj._doc;\n    }\n\n    if (options && options.json && typeof obj.toJSON === 'function') {\n      return obj.toJSON(options);\n    }\n\n    return obj.toObject(options);\n  }\n\n  if (obj.constructor) {\n    switch (getFunctionName(obj.constructor)) {\n      case 'Object':\n        return cloneObject(obj, options, isArrayChild);\n\n      case 'Date':\n        return new obj.constructor(+obj);\n\n      case 'RegExp':\n        return cloneRegExp(obj);\n\n      default:\n        // ignore\n        break;\n    }\n  }\n\n  if (obj instanceof ObjectId) {\n    return new ObjectId(obj.id);\n  }\n\n  if (isBsonType(obj, 'Decimal128')) {\n    if (options && options.flattenDecimals) {\n      return obj.toJSON();\n    }\n\n    return Decimal.fromString(obj.toString());\n  }\n\n  if (!obj.constructor && isObject(obj)) {\n    // object created with Object.create(null)\n    return cloneObject(obj, options, isArrayChild);\n  }\n\n  if (obj[symbols.schemaTypeSymbol]) {\n    return obj.clone();\n  } // If we're cloning this object to go into a MongoDB command,\n  // and there's a `toBSON()` function, assume this object will be\n  // stored as a primitive in MongoDB and doesn't need to be cloned.\n\n\n  if (options && options.bson && typeof obj.toBSON === 'function') {\n    return obj;\n  }\n\n  if (obj.valueOf != null) {\n    return obj.valueOf();\n  }\n\n  return cloneObject(obj, options, isArrayChild);\n}\n\nmodule.exports = clone;\n/*!\n * ignore\n */\n\nfunction cloneObject(obj, options, isArrayChild) {\n  const minimize = options && options.minimize;\n  const ret = {};\n  let hasKeys;\n\n  if (obj[trustedSymbol]) {\n    ret[trustedSymbol] = obj[trustedSymbol];\n  }\n\n  for (const k of Object.keys(obj)) {\n    if (specialProperties.has(k)) {\n      continue;\n    } // Don't pass `isArrayChild` down\n\n\n    const val = clone(obj[k], options);\n\n    if (!minimize || typeof val !== 'undefined') {\n      if (minimize === false && typeof val === 'undefined') {\n        delete ret[k];\n      } else {\n        hasKeys || (hasKeys = true);\n        ret[k] = val;\n      }\n    }\n  }\n\n  return minimize && !isArrayChild ? hasKeys && ret : ret;\n}\n\nfunction cloneArray(arr, options) {\n  const ret = [];\n\n  for (const item of arr) {\n    ret.push(clone(item, options, true));\n  }\n\n  return ret;\n}","map":{"version":3,"sources":["/home/gregorian/calendar-ui/node_modules/mongoose/lib/helpers/clone.js"],"names":["cloneRegExp","require","Decimal","ObjectId","specialProperties","isMongooseObject","getFunctionName","isBsonType","isObject","symbols","trustedSymbol","utils","clone","obj","options","isArrayChild","Array","isArray","cloneArray","_skipSingleNestedGetters","$isSingleNested","Object","assign","getters","isPOJO","$__","_doc","json","toJSON","toObject","constructor","cloneObject","id","flattenDecimals","fromString","toString","schemaTypeSymbol","bson","toBSON","valueOf","module","exports","minimize","ret","hasKeys","k","keys","has","val","arr","item","push"],"mappings":"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","sourcesContent":["'use strict';\n\n\nconst cloneRegExp = require('regexp-clone');\nconst Decimal = require('../types/decimal128');\nconst ObjectId = require('../types/objectid');\nconst specialProperties = require('./specialProperties');\nconst isMongooseObject = require('./isMongooseObject');\nconst getFunctionName = require('./getFunctionName');\nconst isBsonType = require('./isBsonType');\nconst isObject = require('./isObject');\nconst symbols = require('./symbols');\nconst trustedSymbol = require('./query/trusted').trustedSymbol;\nconst utils = require('../utils');\n\n\n/*!\n * Object clone with Mongoose natives support.\n *\n * If options.minimize is true, creates a minimal data object. Empty objects and undefined values will not be cloned. This makes the data payload sent to MongoDB as small as possible.\n *\n * Functions are never cloned.\n *\n * @param {Object} obj the object to clone\n * @param {Object} options\n * @param {Boolean} isArrayChild true if cloning immediately underneath an array. Special case for minimize.\n * @return {Object} the cloned object\n * @api private\n */\n\nfunction clone(obj, options, isArrayChild) {\n  if (obj == null) {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return cloneArray(obj, options);\n  }\n\n  if (isMongooseObject(obj)) {\n    // Single nested subdocs should apply getters later in `applyGetters()`\n    // when calling `toObject()`. See gh-7442, gh-8295\n    if (options && options._skipSingleNestedGetters && obj.$isSingleNested) {\n      options = Object.assign({}, options, { getters: false });\n    }\n\n    if (utils.isPOJO(obj) && obj.$__ != null && obj._doc != null) {\n      return obj._doc;\n    }\n\n    if (options && options.json && typeof obj.toJSON === 'function') {\n      return obj.toJSON(options);\n    }\n    return obj.toObject(options);\n  }\n\n  if (obj.constructor) {\n    switch (getFunctionName(obj.constructor)) {\n      case 'Object':\n        return cloneObject(obj, options, isArrayChild);\n      case 'Date':\n        return new obj.constructor(+obj);\n      case 'RegExp':\n        return cloneRegExp(obj);\n      default:\n        // ignore\n        break;\n    }\n  }\n\n  if (obj instanceof ObjectId) {\n    return new ObjectId(obj.id);\n  }\n\n  if (isBsonType(obj, 'Decimal128')) {\n    if (options && options.flattenDecimals) {\n      return obj.toJSON();\n    }\n    return Decimal.fromString(obj.toString());\n  }\n\n  if (!obj.constructor && isObject(obj)) {\n    // object created with Object.create(null)\n    return cloneObject(obj, options, isArrayChild);\n  }\n\n  if (obj[symbols.schemaTypeSymbol]) {\n    return obj.clone();\n  }\n\n  // If we're cloning this object to go into a MongoDB command,\n  // and there's a `toBSON()` function, assume this object will be\n  // stored as a primitive in MongoDB and doesn't need to be cloned.\n  if (options && options.bson && typeof obj.toBSON === 'function') {\n    return obj;\n  }\n\n  if (obj.valueOf != null) {\n    return obj.valueOf();\n  }\n\n  return cloneObject(obj, options, isArrayChild);\n}\nmodule.exports = clone;\n\n/*!\n * ignore\n */\n\nfunction cloneObject(obj, options, isArrayChild) {\n  const minimize = options && options.minimize;\n  const ret = {};\n  let hasKeys;\n\n  if (obj[trustedSymbol]) {\n    ret[trustedSymbol] = obj[trustedSymbol];\n  }\n\n  for (const k of Object.keys(obj)) {\n    if (specialProperties.has(k)) {\n      continue;\n    }\n\n    // Don't pass `isArrayChild` down\n    const val = clone(obj[k], options);\n\n    if (!minimize || (typeof val !== 'undefined')) {\n      if (minimize === false && typeof val === 'undefined') {\n        delete ret[k];\n      } else {\n        hasKeys || (hasKeys = true);\n        ret[k] = val;\n      }\n    }\n  }\n\n  return minimize && !isArrayChild ? hasKeys && ret : ret;\n}\n\nfunction cloneArray(arr, options) {\n  const ret = [];\n\n  for (const item of arr) {\n    ret.push(clone(item, options, true));\n  }\n\n  return ret;\n}"]},"metadata":{},"sourceType":"script"}