{"ast":null,"code":"var _jsxFileName = \"/home/gregorian/calendar-ui/ui/src/components/Calendar/Calendar.js\",\n    _s = $RefreshSig$();\n\nimport styled from \"styled-components\";\nimport NewJobModal from \"../forms/NewJobModal\";\nimport DayLabels from \"../DayLabels\";\nimport Week from \"../Week\";\nimport HourTicks from \"../HourTicks\";\nimport Header from \"../Header\";\nimport settingsContext from \"../Contexts\";\nimport { fetchDays } from \"../../Model/Jobs\";\nimport React from \"react\";\nimport { fitsInWeek } from \"../../utilities/dateUtilities.js\";\nimport JobModal from \"../forms/JobModal\"; //import socketIOClient from \"socket.io-client\";\n\nimport { useWeek } from \"./reducer\";\nimport { useGapi } from \"../../useGapi/useGapi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CalendarStyled = styled.div`\n  margin: 30px;\n  display: grid;\n  grid-template-rows: 60px 60px ${props => String(props.hourHeight * 24) + \"px\"};\n  grid-template-columns: 60px 1fr;\n`;\n_c = CalendarStyled;\nexport default function Calendar() {\n  _s();\n\n  const [daysOnCal, dispatch] = useWeek();\n  const [showNewJobModal, setShowNewJobModal] = React.useState(false);\n  const [displayEvent, setDisplayEvent] = React.useState(null);\n  const [events, setEvents] = React.useState([]);\n  const [gcalEvents, setGcalEvents] = React.useState([]);\n\n  function handleSetInitialDate(day, month, year, hour) {\n    return new Date(day, month, year, hour);\n  } //TODO have a think about what you are using/nameing current day. what does that mean\n  //useGapi also returns a sign out function\n\n\n  const {\n    authed,\n    listEvents\n  } = useGapi();\n  const {\n    hourHeight\n  } = React.useContext(settingsContext);\n\n  const updateDisplayEvent = id => {\n    setDisplayEvent(events.filter(event => event._id === id)[0]);\n  };\n\n  React.useEffect(() => {\n    console.log(day);\n    fetchDays(daysOnCal.firstDay, daysOnCal.lastDay).then(data => {\n      setEvents([...data]); //TODO have a look at what we are doing here what if there is no data\n    }).catch(console.error);\n  }, [daysOnCal]);\n  React.useEffect(() => {\n    if (authed) {\n      listEvents(daysOnCal.firstDay, daysOnCal.lastDay) //TODO should technically be a dependancy need to wrap it in useCallback\n      .then(setGcalEvents);\n      console.log(\"aggghhhh\");\n    }\n  }, [authed, daysOnCal]); //added in the listEvebts due to a warning in conslol\n\n  /*  React.useEffect(()=>{\n        const socket = socketIOClient('http://localhost:8000');\n        console.log(socket)\n         socket.on('message',(msg)=>{\n            fetchWeekContaining(firstDayOfWeek)\n                .then(data=> {\n                    setEvents(data)\n                })\n                .catch(console.error)\n        })\n    },[firstDayOfWeek])*/\n\n  const incrementWeek = () => {\n    dispatch({\n      type: \"INCREMENT\"\n    });\n  };\n\n  const decrementWeek = () => {\n    dispatch({\n      type: \"DECREMENT\"\n    });\n  };\n\n  const toggleNewJobModal = () => {\n    setShowNewJobModal(val => !val);\n  };\n\n  const closeDetailsModal = () => {\n    setDisplayEvent(null);\n  };\n\n  const addToEvents = event => {\n    if (fitsInWeek(daysOnCal.firstDay, event.start)) {\n      setEvents(events => [...events, event]);\n    }\n  };\n\n  const updateEvent = (id, data) => {\n    setEvents(events => {\n      const remainder = events.filter(event => event._id !== id);\n      const result = [...remainder, data];\n      return result;\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CalendarStyled, {\n      hourHeight: hourHeight,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Header, {\n        currentDate: daysOnCal.currentDate,\n        incrementWeek: incrementWeek,\n        decrementWeek: decrementWeek,\n        handleShowModal: toggleNewJobModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DayLabels, {\n        days: daysOnCal.days\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(HourTicks, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Week, {\n        events: events,\n        gcalEvents: gcalEvents,\n        days: daysOnCal.days,\n        updateDisplayEvent: updateDisplayEvent,\n        updateEvent: updateEvent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this), showNewJobModal && /*#__PURE__*/_jsxDEV(NewJobModal, {\n      addToEvents: addToEvents,\n      toggleModal: toggleNewJobModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }, this), displayEvent && /*#__PURE__*/_jsxDEV(JobModal, {\n      displayEvent: displayEvent,\n      close: closeDetailsModal,\n      updateEvent: updateEvent\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Calendar, \"h9zfa0tsilJb64qpuRS0CO8l0os=\", false, function () {\n  return [useWeek, useGapi];\n});\n\n_c2 = Calendar;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CalendarStyled\");\n$RefreshReg$(_c2, \"Calendar\");","map":{"version":3,"sources":["/home/gregorian/calendar-ui/ui/src/components/Calendar/Calendar.js"],"names":["styled","NewJobModal","DayLabels","Week","HourTicks","Header","settingsContext","fetchDays","React","fitsInWeek","JobModal","useWeek","useGapi","CalendarStyled","div","props","String","hourHeight","Calendar","daysOnCal","dispatch","showNewJobModal","setShowNewJobModal","useState","displayEvent","setDisplayEvent","events","setEvents","gcalEvents","setGcalEvents","handleSetInitialDate","day","month","year","hour","Date","authed","listEvents","useContext","updateDisplayEvent","id","filter","event","_id","useEffect","console","log","firstDay","lastDay","then","data","catch","error","incrementWeek","type","decrementWeek","toggleNewJobModal","val","closeDetailsModal","addToEvents","start","updateEvent","remainder","result","currentDate","days"],"mappings":"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","sourcesContent":["import styled from \"styled-components\";\nimport NewJobModal from \"../forms/NewJobModal\";\n\nimport DayLabels from \"../DayLabels\";\nimport Week from \"../Week\";\nimport HourTicks from \"../HourTicks\";\n\nimport Header from \"../Header\";\nimport settingsContext from \"../Contexts\";\n\nimport { fetchDays } from \"../../Model/Jobs\";\n\nimport React from \"react\";\nimport { fitsInWeek } from \"../../utilities/dateUtilities.js\";\n\nimport JobModal from \"../forms/JobModal\";\n\n\n//import socketIOClient from \"socket.io-client\";\n\nimport { useWeek } from \"./reducer\";\nimport { useGapi } from \"../../useGapi/useGapi\";\n\nconst CalendarStyled = styled.div`\n  margin: 30px;\n  display: grid;\n  grid-template-rows: 60px 60px ${(props) =>\n      String(props.hourHeight * 24) + \"px\"};\n  grid-template-columns: 60px 1fr;\n`;\n\nexport default function Calendar() {\n  const [daysOnCal, dispatch] = useWeek();\n  const [showNewJobModal, setShowNewJobModal] = React.useState(false);\n  const [displayEvent, setDisplayEvent] = React.useState(null);\n  const [events, setEvents] = React.useState([]);\n  const [gcalEvents, setGcalEvents] = React.useState([]);\n\n  function handleSetInitialDate(day,month,year,hour){\n       return new Date(day,month,year,hour) \n  }\n\n  //TODO have a think about what you are using/nameing current day. what does that mean\n\n  //useGapi also returns a sign out function\n  const { authed, listEvents } = useGapi();\n\n  const { hourHeight } = React.useContext(settingsContext);\n\n  const updateDisplayEvent = (id) => {\n    setDisplayEvent(events.filter((event) => event._id === id)[0]);\n  };\n\n  React.useEffect(() => {\n    console.log(day)\n    fetchDays(daysOnCal.firstDay, daysOnCal.lastDay)\n      .then((data) => {\n        setEvents([...data]); //TODO have a look at what we are doing here what if there is no data\n      })\n      .catch(console.error);\n  }, [daysOnCal]);\n\n  React.useEffect(() => {\n    if (authed) {\n      listEvents(daysOnCal.firstDay, daysOnCal.lastDay) //TODO should technically be a dependancy need to wrap it in useCallback\n        .then(setGcalEvents);\n\n      console.log(\"aggghhhh\");\n    }\n  }, [authed, daysOnCal]); //added in the listEvebts due to a warning in conslol\n\n  /*  React.useEffect(()=>{\n        const socket = socketIOClient('http://localhost:8000');\n        console.log(socket)\n\n        socket.on('message',(msg)=>{\n            fetchWeekContaining(firstDayOfWeek)\n                .then(data=> {\n                    setEvents(data)\n                })\n                .catch(console.error)\n        })\n    },[firstDayOfWeek])*/\n\n  const incrementWeek = () => {\n    dispatch({ type: \"INCREMENT\" });\n  };\n\n  const decrementWeek = () => {\n    dispatch({ type: \"DECREMENT\" });\n  };\n\n  const toggleNewJobModal = () => {\n    setShowNewJobModal((val) => !val);\n  };\n\n  const closeDetailsModal = () => {\n    setDisplayEvent(null);\n  };\n\n  const addToEvents = (event) => {\n    if (fitsInWeek(daysOnCal.firstDay, event.start)) {\n      setEvents((events) => [...events, event]);\n    }\n  };\n\n  const updateEvent = (id, data) => {\n    setEvents((events) => {\n      const remainder = events.filter((event) => event._id !== id);\n      const result = [...remainder, data];\n      return result;\n    });\n  };\n\n  return (\n    <React.Fragment>\n      <CalendarStyled hourHeight={hourHeight}>\n        <div></div>\n        <Header\n          currentDate={daysOnCal.currentDate}\n          incrementWeek={incrementWeek}\n          decrementWeek={decrementWeek}\n          handleShowModal={toggleNewJobModal}\n        />\n        <div></div>\n        <DayLabels days={daysOnCal.days} />\n        <HourTicks />\n        <Week\n          events={events}\n          gcalEvents={gcalEvents}\n          days={daysOnCal.days}\n          updateDisplayEvent={updateDisplayEvent}\n          updateEvent={updateEvent}\n        />\n      </CalendarStyled>\n      {showNewJobModal && (\n        <NewJobModal\n          addToEvents={addToEvents}\n          toggleModal={toggleNewJobModal}\n        />\n      )}\n      {displayEvent && (\n        <JobModal\n          displayEvent={displayEvent}\n          close={closeDetailsModal}\n          updateEvent={updateEvent}\n        />\n      )}\n    </React.Fragment>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}