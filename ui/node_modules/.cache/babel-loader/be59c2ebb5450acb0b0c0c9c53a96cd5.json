{"ast":null,"code":"'use strict';\n\nconst documentSchemaSymbol = require('../../helpers/symbols').documentSchemaSymbol;\n\nconst get = require('../../helpers/get');\n\nconst internalToObjectOptions = require('../../options').internalToObjectOptions;\n\nconst utils = require('../../utils');\n\nlet Document;\n\nconst getSymbol = require('../../helpers/symbols').getSymbol;\n\nconst scopeSymbol = require('../../helpers/symbols').scopeSymbol;\n/*!\n * exports\n */\n\n\nexports.compile = compile;\nexports.defineKey = defineKey;\n/*!\n * Compiles schemas.\n */\n\nfunction compile(tree, proto, prefix, options) {\n  Document = Document || require('../../document');\n\n  for (const key of Object.keys(tree)) {\n    const limb = tree[key];\n    const hasSubprops = utils.isPOJO(limb) && Object.keys(limb).length && (!limb[options.typeKey] || options.typeKey === 'type' && limb.type.type);\n    const subprops = hasSubprops ? limb : null;\n    defineKey({\n      prop: key,\n      subprops: subprops,\n      prototype: proto,\n      prefix: prefix,\n      options: options\n    });\n  }\n}\n/*!\n * Defines the accessor named prop on the incoming prototype.\n */\n\n\nfunction defineKey({\n  prop,\n  subprops,\n  prototype,\n  prefix,\n  options\n}) {\n  Document = Document || require('../../document');\n  const path = (prefix ? prefix + '.' : '') + prop;\n  prefix = prefix || '';\n\n  if (subprops) {\n    Object.defineProperty(prototype, prop, {\n      enumerable: true,\n      configurable: true,\n      get: function () {\n        const _this = this;\n\n        if (!this.$__.getters) {\n          this.$__.getters = {};\n        }\n\n        if (!this.$__.getters[path]) {\n          const nested = Object.create(Document.prototype, getOwnPropertyDescriptors(this)); // save scope for nested getters/setters\n\n          if (!prefix) {\n            nested.$__[scopeSymbol] = this;\n          }\n\n          nested.$__.nestedPath = path;\n          Object.defineProperty(nested, 'schema', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: prototype.schema\n          });\n          Object.defineProperty(nested, '$__schema', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: prototype.schema\n          });\n          Object.defineProperty(nested, documentSchemaSymbol, {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: prototype.schema\n          });\n          Object.defineProperty(nested, 'toObject', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function () {\n              return utils.clone(_this.get(path, null, {\n                virtuals: get(this, 'schema.options.toObject.virtuals', null)\n              }));\n            }\n          });\n          Object.defineProperty(nested, '$__get', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function () {\n              return _this.get(path, null, {\n                virtuals: get(this, 'schema.options.toObject.virtuals', null)\n              });\n            }\n          });\n          Object.defineProperty(nested, 'toJSON', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function () {\n              return _this.get(path, null, {\n                virtuals: get(_this, 'schema.options.toJSON.virtuals', null)\n              });\n            }\n          });\n          Object.defineProperty(nested, '$__isNested', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: true\n          });\n\n          const _isEmptyOptions = Object.freeze({\n            minimize: true,\n            virtuals: false,\n            getters: false,\n            transform: false\n          });\n\n          Object.defineProperty(nested, '$isEmpty', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function () {\n              return Object.keys(this.get(path, null, _isEmptyOptions) || {}).length === 0;\n            }\n          });\n          Object.defineProperty(nested, '$__parent', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: this\n          });\n          compile(subprops, nested, path, options);\n          this.$__.getters[path] = nested;\n        }\n\n        return this.$__.getters[path];\n      },\n      set: function (v) {\n        if (v != null && v.$__isNested) {\n          // Convert top-level to POJO, but leave subdocs hydrated so `$set`\n          // can handle them. See gh-9293.\n          v = v.$__get();\n        } else if (v instanceof Document && !v.$__isNested) {\n          v = v.$toObject(internalToObjectOptions);\n        }\n\n        const doc = this.$__[scopeSymbol] || this;\n        doc.$set(path, v);\n      }\n    });\n  } else {\n    Object.defineProperty(prototype, prop, {\n      enumerable: true,\n      configurable: true,\n      get: function () {\n        return this[getSymbol].call(this.$__[scopeSymbol] || this, path);\n      },\n      set: function (v) {\n        this.$set.call(this.$__[scopeSymbol] || this, path, v);\n      }\n    });\n  }\n} // gets descriptors for all properties of `object`\n// makes all properties non-enumerable to match previous behavior to #2211\n\n\nfunction getOwnPropertyDescriptors(object) {\n  const result = {};\n  Object.getOwnPropertyNames(object).forEach(function (key) {\n    const skip = ['isNew', '$__', '$errors', 'errors', '_doc', '$locals', '$op', '__parentArray', '__index', '$isDocumentArrayElement'].indexOf(key) === -1;\n\n    if (skip) {\n      return;\n    }\n\n    result[key] = Object.getOwnPropertyDescriptor(object, key);\n    result[key].enumerable = false;\n  });\n  return result;\n}","map":{"version":3,"sources":["/home/gregorian/calendar-ui/node_modules/mongoose/lib/helpers/document/compile.js"],"names":["documentSchemaSymbol","require","get","internalToObjectOptions","utils","Document","getSymbol","scopeSymbol","exports","compile","defineKey","tree","proto","prefix","options","key","Object","keys","limb","hasSubprops","isPOJO","length","typeKey","type","subprops","prop","prototype","path","defineProperty","enumerable","configurable","_this","$__","getters","nested","create","getOwnPropertyDescriptors","nestedPath","writable","value","schema","clone","virtuals","_isEmptyOptions","freeze","minimize","transform","set","v","$__isNested","$__get","$toObject","doc","$set","call","object","result","getOwnPropertyNames","forEach","skip","indexOf","getOwnPropertyDescriptor"],"mappings":"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","sourcesContent":["'use strict';\n\nconst documentSchemaSymbol = require('../../helpers/symbols').documentSchemaSymbol;\nconst get = require('../../helpers/get');\nconst internalToObjectOptions = require('../../options').internalToObjectOptions;\nconst utils = require('../../utils');\n\nlet Document;\nconst getSymbol = require('../../helpers/symbols').getSymbol;\nconst scopeSymbol = require('../../helpers/symbols').scopeSymbol;\n\n/*!\n * exports\n */\n\nexports.compile = compile;\nexports.defineKey = defineKey;\n\n/*!\n * Compiles schemas.\n */\n\nfunction compile(tree, proto, prefix, options) {\n  Document = Document || require('../../document');\n\n  for (const key of Object.keys(tree)) {\n    const limb = tree[key];\n\n    const hasSubprops = utils.isPOJO(limb) && Object.keys(limb).length &&\n      (!limb[options.typeKey] || (options.typeKey === 'type' && limb.type.type));\n    const subprops = hasSubprops ? limb : null;\n\n    defineKey({ prop: key, subprops: subprops, prototype: proto, prefix: prefix, options: options });\n  }\n}\n\n/*!\n * Defines the accessor named prop on the incoming prototype.\n */\n\nfunction defineKey({ prop, subprops, prototype, prefix, options }) {\n  Document = Document || require('../../document');\n  const path = (prefix ? prefix + '.' : '') + prop;\n  prefix = prefix || '';\n\n  if (subprops) {\n    Object.defineProperty(prototype, prop, {\n      enumerable: true,\n      configurable: true,\n      get: function() {\n        const _this = this;\n        if (!this.$__.getters) {\n          this.$__.getters = {};\n        }\n\n        if (!this.$__.getters[path]) {\n          const nested = Object.create(Document.prototype, getOwnPropertyDescriptors(this));\n\n          // save scope for nested getters/setters\n          if (!prefix) {\n            nested.$__[scopeSymbol] = this;\n          }\n          nested.$__.nestedPath = path;\n\n          Object.defineProperty(nested, 'schema', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: prototype.schema\n          });\n\n          Object.defineProperty(nested, '$__schema', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: prototype.schema\n          });\n\n          Object.defineProperty(nested, documentSchemaSymbol, {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: prototype.schema\n          });\n\n          Object.defineProperty(nested, 'toObject', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function() {\n              return utils.clone(_this.get(path, null, {\n                virtuals: get(this, 'schema.options.toObject.virtuals', null)\n              }));\n            }\n          });\n\n          Object.defineProperty(nested, '$__get', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function() {\n              return _this.get(path, null, {\n                virtuals: get(this, 'schema.options.toObject.virtuals', null)\n              });\n            }\n          });\n\n          Object.defineProperty(nested, 'toJSON', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function() {\n              return _this.get(path, null, {\n                virtuals: get(_this, 'schema.options.toJSON.virtuals', null)\n              });\n            }\n          });\n\n          Object.defineProperty(nested, '$__isNested', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: true\n          });\n\n          const _isEmptyOptions = Object.freeze({\n            minimize: true,\n            virtuals: false,\n            getters: false,\n            transform: false\n          });\n          Object.defineProperty(nested, '$isEmpty', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: function() {\n              return Object.keys(this.get(path, null, _isEmptyOptions) || {}).length === 0;\n            }\n          });\n\n          Object.defineProperty(nested, '$__parent', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: this\n          });\n\n          compile(subprops, nested, path, options);\n          this.$__.getters[path] = nested;\n        }\n\n        return this.$__.getters[path];\n      },\n      set: function(v) {\n        if (v != null && v.$__isNested) {\n          // Convert top-level to POJO, but leave subdocs hydrated so `$set`\n          // can handle them. See gh-9293.\n          v = v.$__get();\n        } else if (v instanceof Document && !v.$__isNested) {\n          v = v.$toObject(internalToObjectOptions);\n        }\n        const doc = this.$__[scopeSymbol] || this;\n        doc.$set(path, v);\n      }\n    });\n  } else {\n    Object.defineProperty(prototype, prop, {\n      enumerable: true,\n      configurable: true,\n      get: function() {\n        return this[getSymbol].call(this.$__[scopeSymbol] || this, path);\n      },\n      set: function(v) {\n        this.$set.call(this.$__[scopeSymbol] || this, path, v);\n      }\n    });\n  }\n}\n\n// gets descriptors for all properties of `object`\n// makes all properties non-enumerable to match previous behavior to #2211\nfunction getOwnPropertyDescriptors(object) {\n  const result = {};\n\n  Object.getOwnPropertyNames(object).forEach(function(key) {\n    const skip = [\n      'isNew',\n      '$__',\n      '$errors',\n      'errors',\n      '_doc',\n      '$locals',\n      '$op',\n      '__parentArray',\n      '__index',\n      '$isDocumentArrayElement'\n    ].indexOf(key) === -1;\n    if (skip) {\n      return;\n    }\n\n    result[key] = Object.getOwnPropertyDescriptor(object, key);\n    result[key].enumerable = false;\n  });\n\n  return result;\n}\n"]},"metadata":{},"sourceType":"script"}